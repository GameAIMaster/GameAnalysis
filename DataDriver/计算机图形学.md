## 引言

### 什么是计算机图形学

计算机图形学是利用计算机技术创建和处理图像的理论、方法和技术。该篇主要讲解图形生成算法





### 图形流水线(graphic pipline)

是一个特别的软硬件子系统，能高效绘出透视图中的三维图元。流水线的基本运算是把三维顶点位置映射到二维屏幕位置。并对三角形进行明暗处理。 

前后层次画三角形的问题一般通过z缓冲技术解决。

图形流水线中的几何运算，在**四维空间坐标几乎都可以实现**（在齐次坐标下平移旋转缩放透视投影等可表示维一般矩阵与向量相乘的一般运算），四维坐标由三维几何坐标和利于处理透视问题的第四维齐次坐标。

### 效率

在具体机器和编译上优化后都需要进行性能分析，确定优化有没有效果。

### KISS原则

keep it simple,stupid. 不能一味的追求有意义而增加复杂性，例如区分位置和位移。但是他们都是三维向量类。

### 

**减少内存使用并保持一致的内存存取是提高效率的关键。**

 - 单精度与双精度设置
 - 内联是实用类（如RGB）提高效率的关键。
 - 讲运算声明在类的外部

**使用调试器越来愈少的原因：**

1. 调试复杂程序比调试简单程序更麻烦
2. 最难发现的错误都是概念上的错误，即所实现的目标就错了，而采取步进运行观察变量值的调试方法浪费了大量时间。

**图形学程序中解决方法：**构建一幅图像，观察有什么问题，然后针对产生的问题的可能原因做出假设，并进行验证。类似于反证法。

## 数学知识

图形学很大程度上就直接把数学表达式转换成代码。

### 实用三角函数

$$
atan2(s,c) 非常有用，s与sinA成正比，c与cosA成正比，且比例因子相同，atan2(s,c)的函数值是A.
$$

![atan2](.\Graph\1595728409.jpg)



球面坐标系中fai = acos(z/(x^2+y^2+z^2)),theta = atan2(y,x)

###　三角形 

#### 重心坐标系 

非直角坐标系

![重心坐标系](.\Graph\1595768623.jpg)

![求点P坐标](.\Graph\1595768930.jpg)

为什么说在图形学中，希望为三角形顶点赋以性质，如颜色。并将该性质的值插值到三角形中？

有了重心坐标系，确实每个顶点都有了自己的系数，后面解释道可以用相同系数计算其他性质。



## 光栅算法

what：像素排成矩阵阵列，被称为光栅。

显示亮度和gama值，伽马值是亮度调节系数，输入的亮度值为0.5实际观察亮度可能只有0.25，呈现非线性，可以用a^gama近似

#### 三角形光栅化

利用上一章的三角形重心坐标系可以完成三角形的颜色插值计算。根据判断点是否在三角形内进行插值，这里还会涉及像素中心位于边上的点，简单有效的方法就是随意选择一个归属的三角形。

#### 简单的反走样技术

盒式滤波器是简单的反走样技术。先提高分辨率，再进行平均压缩。

## 信号处理
###  卷积
卷积的本质是滑动平均思想，唯一的不同是卷积中的滑动平均是加权平均。


离散
$$
(a*b)[i]=\sum_{j}a[j]b[i-j]
$$
有限支撑集：只在自变量的有限区域内取非零值
$$
(a*b)[i]=\sum_{j=-r}^{r}a[j]b[i-j]
$$
卷积运算满足交换律、结合律、对加法满足分配率。

#### 卷积滤波器
1. 卷积滤波器可以模拟盒式滤波器

2. 把卷积看作是位移滤波器之和

3. 通过了解了一个样本求a*b，如果b是一个序列，则可以通过移动j个在乘上权重求和来计算整个序列的卷积。

有了狄拉克函数（tha(a)），离散脉冲函数（0，0，0，1，0，0，0）

采样可以将连续转换为**离散**

离散函数或者序列到连续的转化，称为**重构**，实现重构要用到离散-连续卷积形式。用连续滤波器f(x)对离散序列a[i]进行滤波：
$$
(a*f)(x)=\sum_{i}a[i]f(x-i)
$$

对x=5.3,f的半径为2，为什么在点1.3、0.3、-0.7和-1.7处计算f的值？因为根据定义重构函数a*f在x处的值，就是x附近关于i值的样本a[i]的加权和。权值来自滤波器间距为一个单位个点处的函数值。

#### 滤波器种类

盒式滤波器，帐篷滤波器，高斯滤波器，三次B样条滤波器，三次Catmull-Rom滤波器（作为重构滤波器会插值样本，因为在f(0) = 1，而在-2、-1、1、2处值为0不影响原来样本数据），三次Mithchell-Netravali滤波器。

扩展到多维，则利用**可分滤波器**
$$
f_{2}(x,y)=f_{1}(x)f_{1}(y)
$$
即利用已知的一维滤波器来构建合适的二维滤波器，它们在横、纵刨面具有相似性。



### 图像信号处理

利用卷积滤波器可以锐化图像，柔和阴影。

 **重采样（重构+采样） 改变采样速度或者改变图像大小。重采样滤波器的应用能在清晰和反走样之间平衡** 

### 采样理论

#### 傅里叶变换

与卷积的关系,两个函数卷积的傅里叶变换，等于他们的傅里叶变换的乘积
$$
F\{f*g\}=f^f g^f
$$

两函数的傅里叶变化的卷积，等于他们的乘积的傅里叶变换
$$
f^f * g^f = F\{fg\}
$$

高采样速度使走样谱离的更远，从而减少重叠带来的问题。信号中出现的最高频率必须小于采样频率的一半（尼奎斯特指标），原则上可以根据样本进行准确重构。

1. 避免采样走样。利用低通滤波器，缩小频谱，消除重叠；或者提高采样频率，可以使走样谱离得更远
2. 避免重构走样，重构滤波器的作用是去除走样谱的同时保留基频谱。因此好的重构滤波器要成为好的低通滤波器，还有能够完全阻止所有采样频率倍频出的频谱。 不懂。
3. 避免重采样走样。重采样滤波器既重构信号（去除走样谱），又进行带宽限制（减少带宽）一遍用心的速度采样。





## 矩阵

奇异矩阵：对应的行列式等于0的方阵  .仿真中存在两行以上的相同数据，为奇异矩阵，不可逆，且行列值为0



### 特征值及矩阵对角化

方阵具有特征值和对应的特征向量，特征向量是指与矩阵相乘时方向不变的非零向量。
$$
Aa=\lambda I a
$$
a为特征向量，lambda为特征值，I 为单位矩阵 缩小0.5倍表示成
$$
\left[
\matrix{
  0.5 & 0\\
  0 & 0.5\\
}
\right]*
\left[
\matrix{
  x\\
  y\\
}
\right] = 0.5*
\left[
\matrix{
  x\\
  y\\
}
\right]
$$
经过变换会变成$$ (A-\lambda I)a = 0 $$ 所以当$$A-\lambda I$$ 为奇异矩阵，等式成立。

比较特殊的情况是求对称矩阵的特征值，例如$$ A = A^T$$ ,对称矩阵的特征值都是实数，如果特征值都不想等，则他们的特征向量相互正交，这样的矩阵可以写成**对角形式**：
$$
A=RDR^T
$$
D是对角矩阵，是λ的解，R是一个正交矩阵,如 只取单位矩阵
$$
\left[
\matrix{
  0.8507 & -0.5257\\
  0.5257 & 0.8507\\
}
\right]
$$
为什么要求一个矩阵的特征向量？求出特征向量就能进行奇异值分解

**奇异值分解**是将非对称矩阵进行对角化处理

对角化的意义是什么？为什么要进行奇异值分解？假设矩阵$$M=USV$$ ,U和V是正交矩阵。这和对一个对称矩阵对角形式一致$$A=RDR^T$$ .

假设$$A=MM^T$$ M可以奇异值分解 ，$$A = US^2U^T$$ ,新形式A是对称的 $$A=A^T$$。对称不是简单的旋转矩阵，不要理解错误。

有了A的特征值分解，能够得到U和S，再根据$$V = S^{-1}U^TM$$ ,求出V。

为什么矩阵乘法是书中定义的方式，而不是诸葛元素相乘？ 是因为多数矩阵都是用来变换向量，例如在三维空间中，我们有$$b=Ma$$ ，a和b都是向量M是一个3*3矩阵，像旋转这样的几何变换，b中的每个元素都是a中的所有元素同时参与运算的结果。这是在几何中。在线性代数中类似，每一行代表的是方程的变量的系数，每一列代表变量的取值。